(window.webpackJsonp=window.webpackJsonp||[]).push([[12,14],{Ct9w:function(t,e,s){"use strict";s.r(e),s.d(e,"ResourcesModule",function(){return M});var r=s("mrSG"),n=s("ebz3"),a=s("fXoL"),o=s("ofXK"),i=s("/Uzn"),l=s("d+0u"),d=s("9+1D"),c=s("FQmJ"),p=s("r6MX"),u=s("5eHb"),m=s("tyNb"),h=s("LvDl");let g=class extends p.a{constructor(t,e,s,r,n,a,o){super(),this.route=t,this.router=e,this.tokenService=s,this.dataService=r,this.constants=n,this.functions=a,this.toastr=o,this.pk="resourceID",this.title="Resources",this.object="Resource",this.dashboardUrl="/dashboard",this.parentUrl="/resources/folders",this.knowlegeUrl="/resources/knowledge-center",this.openUrl="/resources/open/",this.browseUrl="/resources/folders",this.uploadUrl="/resources/upload",this.createUrl="/resources/create-folder",this.editUrl="/resources/edit-folder/",this.rows=[],this.errorMessage=null,this.filter={term:null,order:["resourceType DESC","resourceName DESC"]},this.moduleCode="",this.parentID=null,this.parents=[],this.parentIDPane=null,this.parentsPane=[],this.loading=!1,this.isMovePaneOpen=!1,this.rowsMovePane=[],this.order.resourceType="DESC",this.order.resourceName="DESC"}ngOnInit(){this.parentUrl="kwt"==this.moduleCode?this.knowlegeUrl:this.parentUrl,this.route.queryParams.subscribe(t=>{let e=t.parentID||null,s=t.moduleCode||"rsc",r=t.parentIDPane||null,n=t.isMovePaneOpen||!1;this.loadRecords(s,e),this.openMovePane(r,n)})}loadRecords(t,e,s){this.parentID=e,this.moduleCode=t;let r={moduleCode:this.moduleCode,parentID:e};s&&""!=s.trim()?r={moduleCode:{neq:"kwt"},resourceName:{like:s.trim(),options:"i"},resourceType:"file"}:this.filter.term=null,Object.assign(r,{isArchived:{neq:"Y"}}),this.dataService.getAll({limit:100,where:r,order:this.filter.order}).subscribe(t=>{this.rows=t},t=>{this.errorMessage=i.a.handleError(t,l.a.Messages.RECORDS_NOT_FOUND),this.toastr.error(this.errorMessage,l.a.Title.RECORD_OPERATION)});let n=this.constants.moduleCodes[this.moduleCode];this.parents=[{name:n.plural}],this.dataService.getParents(e).subscribe(t=>{for(let e of t)this.parents.push(e)})}openMovePane(t,e){if(!e)return;this.parentIDPane=t,this.isMovePaneOpen=e;let s={moduleCode:this.moduleCode,parentID:t};Object.assign(s,{isArchived:{neq:"Y"}}),this.dataService.getAll({limit:100,where:s}).subscribe(t=>{this.rowsMovePane=t},t=>{this.errorMessage=i.a.handleError(t,l.a.Messages.RECORDS_NOT_FOUND),this.toastr.error(this.errorMessage,l.a.Title.RECORD_OPERATION)});let r=this.constants.moduleCodes[this.moduleCode];this.parentsPane=[{name:r.plural}],this.dataService.getParents(t).subscribe(t=>{for(let e of t)this.parentsPane.push(e)})}closeMovePane(){this.isMovePaneOpen=!1,this.rowsMovePane=[],this.parentIDPane=null}deleteRow(t){return Object(r.b)(this,void 0,void 0,function*(){let e="Y"==t.isArchived?l.a.Messages.CONFIRM_RESTORE:l.a.Messages.CONFIRM_DELETE,s=yield i.a.alertDelete(l.a.Title.RECORD_OPERATION,e);(null==s?void 0:s.value)&&(Object.assign(t,{isDeleting:!0}),this.dataService.delete(t[this.pk]).subscribe(s=>{Object.assign(t,{isDeleting:!1}),e="Y"==t.isArchived?l.a.Messages.RESTORE_SUCCESS:l.a.Messages.DELETE_SUCCESS,this.rows=this.rows.filter(e=>e[this.pk]!==t[this.pk]),this.toastr.success(e,l.a.Title.RECORD_OPERATION)},s=>{Object.assign(t,{isDeleting:!1}),e="Y"==t.isArchived?l.a.Messages.RESTORE_FAILURE:l.a.Messages.DELETE_FAILURE,this.errorMessage=i.a.handleError(s,e),this.toastr.error(this.errorMessage,l.a.Title.RECORD_OPERATION)}))})}allowDrop(t,e){t.preventDefault()}drag(t,e){t.dataTransfer.setData("resourceID",e.resourceID),t.dataTransfer.setData("resourceName",e.resourceName)}drop(t,e,s=!0){return Object(r.b)(this,void 0,void 0,function*(){t.preventDefault();let r=t.dataTransfer.getData("resourceID"),n=t.dataTransfer.getData("resourceName"),a=e&&e.resourceID||null;if("folder"!=e.resourceType||r==a||this.tokenService.getUserType()!=this.constants.userTypes.admin.name)return;let o='Do you want to move "'+n+'" to \n"'+e.resourceName+'"?',d=yield i.a.alertDelete(l.a.Title.RECORD_OPERATION,o);(null==d?void 0:d.value)&&(this.loading=!0,this.dataService.update(r,{parentID:a}).subscribe(()=>{let t=[];t=this.isMovePaneOpen&&s?this.rowsMovePane:this.rows;let e=h.findIndex(t,{resourceID:r});e>=0&&t.splice(e,1),this.toastr.success(l.a.Messages.RESOURCE_MOVE,l.a.Title.RECORD_OPERATION)}).add(()=>{this.loading=!1}))})}goBack(){if(this.parents.length>1){let t={parentID:this.parents[this.parents.length-2].id,moduleCode:this.moduleCode,fullScreen:"N"};this.router.navigate([this.parentUrl],{queryParams:t})}else this.router.navigate([this.dashboardUrl],{queryParams:{fullScreen:"N"}})}};g.ctorParameters=()=>[{type:m.a},{type:m.f},{type:c.a},{type:d.a},{type:l.a},{type:i.a},{type:u.b}],g=Object(r.c)([Object(a.Component)({selector:"resources",template:'<div class="row">\n\t<div class="col-sm-12">\n\t    <app-card hidHeader="true" cardClass="table-card" blockClass="p-0">\n\t    \t<div class="row">\n\t    \t\t<div class="col-md-3 col-sm-12 pr-0">\n\t    \t\t\t<div class="form-group pb-3 pt-3 pl-3"\n\t    \t\t\t\t*ngIf="tokenService.getUserType()==constants.userTypes.admin.name">\n\t\t    \t\t\t<a *ngIf="tokenService.getUserType()==constants.userTypes.admin.name"\n\t\t\t           \t\ttitle="Upload {{object}}" \n\t\t\t           \t\tclass="btn waves-effect waves-light btn-rounded btn-outline-primary" \n\t\t\t           \t\trouterLink="{{createUrl}}" \n\t\t\t           \t\t[queryParams]="{parentID:parentID, moduleCode:moduleCode}">\n\t\t\t\t\t\t\t<i class="fa fa-plus"></i> Create Folder\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</div>\n\t\t\t    \t<ul class="nav nav-pills mb-3 mt-3 mr-2 ml-2">\n\t\t\t    \t\t<ng-container *ngFor="let m of functions.indexify(this.constants.moduleCodes)\n\t\t\t\t    \t\t\t| KeyFilter:\'isResourcePack\':true">\n\t\t\t\t\t    \t<li class="nav-item"  *ngIf="tokenService.getModules().indexOf(m.name)>-1">\n\t\t\t\t\t    \t\t<a type="button" class="nav-link {{moduleCode==m.name? \'active\' : \'\'}}" \n\t\t\t\t\t    \t\t  routerLink="{{browseUrl}}" [queryParams]="{moduleCode:m.name}">\n\t\t\t\t\t    \t\t\t<i class="fa fa-folder text-warning m-r-10"></i>\n\t\t\t\t\t    \t\t\t{{m?.plural | TitleCase}}\n\t\t\t\t\t    \t\t\t<br/>\n\t\t\t\t\t    \t\t</a>\n\t\t\t\t\t    \t</li>\n\t\t\t\t    \t</ng-container>\n\t\t\t\t  \t</ul>\n\t\t\t\t</div>\t\t  \t\n\t\t\t\t<div class="col-md-9 col-sm-12 pr-5">\n\t\t\t    \t<div class="form-row mt-3 mb-0">\t\t\t  \t\n\t\t\t\t\t\t<div class="form-group {{tokenService.getUserType()==constants.userTypes.admin.name? \'col-md-6\' : \'col-md-12\'}} col-sm-12">\n\t\t\t\t\t\t\t<input class="form-control" placeholder="Search {{object}} Here.." [(ngModel)]="filter.term"\n\t\t\t\t\t\t\t\t(keyup)="($event.keyCode == 13 ? loadRecords(moduleCode,parentID,filter.term) : null)"/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t  \t<div class="form-group col-md-6 col-sm-12 text-right"\n\t\t\t\t\t  \t\t*ngIf="tokenService.getUserType()==constants.userTypes.admin.name">\n\t\t\t\t\t  \t\t\n\t\t\t\t\t  \t\t<a *ngIf="tokenService.getUserType()==constants.userTypes.admin.name && !isMovePaneOpen"\n\t\t\t\t           \t\ttitle="Drag and drop Side By Side" class="btn waves-effect waves-light btn-rounded btn-success" \n\t\t\t\t           \t\t(click)="openMovePane(parentID,moduleCode)">\n\t\t\t\t\t\t\t\t<i class="fa fa-arrows-alt"></i> Open Explorer\n\t\t\t\t\t\t\t</a>\t\t\t\t\t\t\t\n\t\t\t\t\t  \t\t<a *ngIf="tokenService.getUserType()==constants.userTypes.admin.name && isMovePaneOpen"\n\t\t\t\t           \t\ttitle="Drag and drop Side By Side" class="btn waves-effect waves-light btn-rounded btn-danger" \n\t\t\t\t           \t\t(click)="closeMovePane()">\n\t\t\t\t\t\t\t\t<i class="fa fa-arrows-alt"></i> Close Explorer\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t&nbsp;\n\t\t\t\t            <a *ngIf="tokenService.getUserType()==constants.userTypes.admin.name"\n\t\t\t\t           \t\ttitle="Upload File" class="btn waves-effect waves-light btn-rounded btn-outline-primary" \n\t\t\t\t           \t\trouterLink="{{uploadUrl}}" \n\t\t\t\t           \t\t[queryParams]="{parentID:parentID,moduleCode:moduleCode}">\n\t\t\t\t\t\t\t\t<i class="fa fa-upload"></i> Upload File\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\t\n\t\t\t\t\t<div class="row">\n\t\t\t\t\t\t\x3c!-- default pane i.e the usual left pane --\x3e\n\t\t\t\t\t\t<div class="col-sm-12 {{isMovePaneOpen? \'col-md-6\' : \'col-md-12\'}}">\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t<div class="form-row mt-0 mb-0">\n\t\t\t\t\t\t\t\t<div class="form-group col-md-12 form-inline pt-0">\n\t\t\t\t\t\t\t\t\t<div *ngFor="let p of parents; let i = index;">\n\t\t\t\t\t\t\t\t\t\t<a *ngIf="i==0" title="{{p.name | TitleCase}}" routerLink="{{browseUrl}}" \n\t\t\t\t\t\t\t            \t[queryParams]="{moduleCode:moduleCode}">\n\t\t\t\t\t\t\t            \t{{p.name | TitleCase}}\n\t\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t\t\t<a *ngIf="i>0" title="{{p.name | TitleCase}}" routerLink="{{browseUrl}}" \n\t\t\t\t\t\t\t            \t[queryParams]="{parentID:p.id,moduleCode:moduleCode}">\n\t\t\t\t\t\t\t            \t{{p.name}}\n\t\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t\t\t<span *ngIf="i<parents.length-1">&nbsp;>>&nbsp;</span>\n\t\t\t\t\t\t\t\t\t\t<span *ngIf="i==parents.length-1">&nbsp;>>&nbsp;</span>\n\t\t\t\t\t\t\t\t\t</div>\t\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t        <div class="table-responsive">\n\t\t\t\t\t          <table class="table table-borderless table-sm resources">\n\t\t\t\t\t          \t<thead>\n\t\t\t\t\t            <tr>\n\t\t\t\t\t              <th width="50" *ngIf="!isMovePaneOpen">#</th>\t\t\t\t\t              \n\t\t\t\t\t\t          <th class="cursor">\n\t\t\t\t\t\t           \tResource Name\n\t\t\t\t\t\t          </th>\n\t\t\t\t\t              <th width="120" class="text-right" *ngIf="!isMovePaneOpen">\n\t\t\t\t\t              \t<span>Actions</span>\n\t\t\t\t\t              </th>\n\t\t\t\t\t            </tr>\t \n\t\t\t\t\t            </thead>                         \t\n\t\t\t\t\t\t\t\t<tr *ngIf="!rows || rows.length==0">\n\t\t\t\t\t\t\t\t\t<td class="text-center" colspan="100%">\n\t\t\t\t\t\t\t\t\t\t{{\n\t\t\t\t\t\t\t\t\t\t\terrorMessage? errorMessage :\n\t\t\t\t\t\t\t\t\t\t\t(\'Search could not find any \'+ title.toLowerCase() + \' records\')\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t        <tr template #elseBlock *ngFor="let row of rows | RandomSearch:filter.term; let i=index" \n\t\t\t\t\t\t        \t data-type="{{row.resourceType}}" data-id="{{row.resourceID}}"\n\t\t\t\t\t\t        \t (drop)="drop($event,row)" (dragover)="allowDrop($event,row)">           \n\t\t\t\t\t\t            <td *ngIf="!isMovePaneOpen">{{i+1}}.</td>\n\t\t\t\t\t\t            <td>\t\t\n\t\t\t\t\t\t            \t<p class="cursor" draggable="true" (dragstart)="drag($event,row)">\t\t            \t\n\t\t\t\t\t\t\t            \t<span class="{{ functions.getResourceIcon(row.mimeType) }} mr-2 ml-2"></span>\n\t\t\t\t\t\t\t            \t<a *ngIf="row.resourceType==\'folder\'" routerLink="{{browseUrl}}" \n\t\t\t\t\t\t\t            \t\t[queryParams]="{parentID:row[pk],moduleCode:moduleCode}">\n\t\t\t\t\t\t\t            \t\t{{row.resourceName}}\n\t\t\t\t\t\t\t            \t</a>\n\t\t\t\t\t\t\t            \t<a *ngIf="row.resourceType==\'file\'" routerLink="{{ openUrl + row[pk] }}" target="_blank"\n\t\t\t\t\t\t\t            \t\t[queryParams]="{parentID:row.parentID, moduleCode:moduleCode, fullScreen:\'Y\'}">\n\t\t\t\t\t\t\t            \t\t{{row.resourceName}}\n\t\t\t\t\t\t\t            \t</a>\n\t\t\t\t\t\t\t            \t<br/>\n\t\t\t\t\t\t\t            \t<span class="font-small">\n\t\t\t\t\t\t\t\t            \t<span *ngIf="false">\n\t\t\t\t\t\t\t\t            \t\tSize: <b>{{ functions.getResourceSize(row.resourceSize) }}&nbsp;</b> |\n\t\t\t\t\t\t\t\t            \t</span>\n\t\t\t\t\t\t\t\t            \t&nbsp; Last Updated On : {{row?.lastUpdated | date:\'dd-MMM-yyyy hh:mm a\'}}\n\t\t\t\t\t\t\t            \t</span>\n\t\t\t\t\t\t            \t</p>\n\t\t\t\t\t\t            </td>\n\t\t\t\t\t\t            <td class="text-right" width="180" *ngIf="!isMovePaneOpen">\n\t\t\t\t\t\t            \t<a title="Open {{object}}" class="text-primary" *ngIf="row.resourceType==\'folder\'" \n\t\t\t\t\t\t            \t\trouterLink="{{browseUrl}}" [queryParams]="{parentID:row[pk],moduleCode:moduleCode}">\n\t\t\t\t\t\t            \t\t<i class="feather icon-eye"></i> Open\n\t\t\t\t\t\t            \t</a>\t\t\t\n\t\t\t\t\t\t            \t<a title="Open {{object}}" class="text-primary" *ngIf="row.resourceType==\'file\'" \n\t\t\t\t\t\t            \t\trouterLink="{{openUrl + row[pk]}}"  target="_blank"\n\t\t\t\t\t\t            \t\t[queryParams]="{parentID:row.parentID, moduleCode:moduleCode, fullScreen:\'Y\'}">\n\t\t\t\t\t\t            \t\t<i class="feather icon-eye"></i> Open\n\t\t\t\t\t\t            \t</a>\t\t\t\n\t\t\t\t\t\t            \t<a title="Edit {{object}}" class="text-success"\n\t\t\t\t\t\t\t\t\t\t\t*ngIf="tokenService.getUserType()==constants.userTypes.admin.name" \n\t\t\t\t\t\t\t\t\t\t\trouterLink="{{editUrl + row[pk]}}"\n\t\t\t\t\t\t\t\t\t\t\t[queryParams]="{parentID:row.parentID, moduleCode:moduleCode}">\n\t\t\t\t\t\t\t\t\t\t\t&nbsp;|&nbsp;&nbsp;<i class="feather icon-edit"></i> Edit\n\t\t\t\t\t\t\t\t\t\t</a>\t\n\t\t\t\t\t\t\t\t\t\t<br/>\t\t\n\t\t\t\t\t\t\t\t\t\t<a *ngIf="tokenService.getUserType()==constants.userTypes.admin.name"\n\t\t\t\t\t\t\t\t\t\t\tclass="text-danger" [disabled]="row?.isDeleting" type="button" \n\t\t\t\t\t\t\t\t\t\t\ttitle="Archive {{object}}" (click)="deleteRow(row)">\n\t\t\t\t\t\t\t\t\t\t\t<span *ngIf="row?.isDeleting" class="spinner-border spinner-border-sm"></span>\n\t\t\t\t\t\t\t\t\t\t\t<span *ngIf="!row?.isDeleting"><i class="feather icon-trash"></i></span>\n\t\t\t\t\t\t\t\t\t\t\tArchive\n\t\t\t\t\t\t\t\t\t\t</a>\t\t\t\n\t\t\t\t\t\t            </td>\n\t\t\t\t\t            </tr>\n\t\t\t\t\t          </table>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\x3c!-- move pane i.e the right pane --\x3e\n\t\t\t\t\t\t<div class="col-md-6" *ngIf="isMovePaneOpen">\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t<div class="form-row mt-0 mb-0">\n\t\t\t\t\t\t\t\t<div class="form-group col-md-12 form-inline pt-0">\n\t\t\t\t\t\t\t\t\t<div *ngFor="let p of parentsPane; let i = index;">\n\t\t\t\t\t\t\t\t\t\t<a *ngIf="i==0" title="{{p.name | TitleCase}}" routerLink="{{browseUrl}}" \n\t\t\t\t\t\t\t            \t[queryParams]="{parentID:parentID,moduleCode:moduleCode,isMovePaneOpen:isMovePaneOpen}"\n\t\t\t\t\t\t\t            \t(drop)="drop($event,null,false)">\n\t\t\t\t\t\t\t            \t{{p.name | TitleCase}}\n\t\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t\t\t<a *ngIf="i>0" title="{{p.name | TitleCase}}" routerLink="{{browseUrl}}" \n\t\t\t\t\t\t\t            \t[queryParams]="{parentID:parentID,parentIDPane:p.id,moduleCode:moduleCode,isMovePaneOpen:isMovePaneOpen}"\n\t\t\t\t\t\t\t            \t(drop)="drop($event,{parentID:p.id},false)">\n\t\t\t\t\t\t\t            \t{{p.name}}\n\t\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t\t\t<span *ngIf="i<parents.length-1">&nbsp;>>&nbsp;</span>\n\t\t\t\t\t\t\t\t\t\t<span *ngIf="i==parents.length-1">&nbsp;>>&nbsp;</span>\n\t\t\t\t\t\t\t\t\t</div>\t\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t        <div class="table-responsive">\n\t\t\t\t\t          <table class="table table-borderless table-sm resources">\n\t\t\t\t\t          \t<thead>\n\t\t\t\t\t            <tr>\n\t\t\t\t\t              <th>Resource Name</th>\n\t\t\t\t\t            </tr>\t \n\t\t\t\t\t            </thead>                         \t\n\t\t\t\t\t\t\t\t<tr *ngIf="!rowsMovePane || rowsMovePane.length==0">\n\t\t\t\t\t\t\t\t\t<td class="text-center" colspan="100%">\n\t\t\t\t\t\t\t\t\t\t{{\n\t\t\t\t\t\t\t\t\t\t\terrorMessage? errorMessage :\n\t\t\t\t\t\t\t\t\t\t\t(\'Search could not find any \'+ title.toLowerCase() + \' records\')\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t        <tr template #elseBlock *ngFor="let row of rowsMovePane | RandomSearch:filter.term | \n\t\t\t\t\t\t        \tOrderBy:[\'resourceName\'] ; let i=index" \n\t\t\t\t\t\t        \t data-type="{{row.resourceType}}" data-id="{{row.resourceID}}"\n\t\t\t\t\t\t        \t (drop)="drop($event,row,false)" (dragover)="allowDrop($event,row)"> \n\t\t\t\t\t\t            <td>\t\t\n\t\t\t\t\t\t            \t<p class="cursor" draggable="true" (dragstart)="drag($event,row)">\t\t            \t\n\t\t\t\t\t\t\t            \t<span class="{{ functions.getResourceIcon(row.mimeType) }} mr-2 ml-2"></span>\n\t\t\t\t\t\t\t            \t<a *ngIf="row.resourceType==\'folder\'" routerLink="{{browseUrl}}" \n\t\t\t\t\t\t\t            \t\t[queryParams]="{parentID:parentID,parentIDPane:row[pk],moduleCode:moduleCode,isMovePaneOpen:isMovePaneOpen}">\n\t\t\t\t\t\t\t            \t\t{{row.resourceName}}\n\t\t\t\t\t\t\t            \t</a>\n\t\t\t\t\t\t\t            \t<a *ngIf="row.resourceType==\'file\'" routerLink="{{ openUrl + row[pk] }}" target="_blank"\n\t\t\t\t\t\t\t            \t\t[queryParams]="{parentID:row.parentID, moduleCode:moduleCode, fullScreen:\'Y\'}">\n\t\t\t\t\t\t\t            \t\t{{row.resourceName}}\n\t\t\t\t\t\t\t            \t</a>\n\t\t\t\t\t\t\t            \t<br/>\n\t\t\t\t\t\t\t            \t<span class="font-small">\n\t\t\t\t\t\t\t\t            \t<span *ngIf="false">\n\t\t\t\t\t\t\t\t            \t\tSize: <b>{{ functions.getResourceSize(row.resourceSize) }}&nbsp;</b> |\n\t\t\t\t\t\t\t\t            \t</span>\n\t\t\t\t\t\t\t\t            \t&nbsp; Last Updated On : {{row?.lastUpdated | date:\'dd-MMM-yyyy hh:mm a\'}}\n\t\t\t\t\t\t\t            \t</span>\n\t\t\t\t\t\t            \t</p>\n\t\t\t\t\t\t            </td>\n\t\t\t\t\t            </tr>\n\t\t\t\t\t          </table>\n\t\t\t\t\t\t    </div>\n\t\t\t\t\t\t</div>\n\t\t\t        </div>\n\t\t\t        <div class="form-group form-inline pl-0">\n\t\t\t\t\t\t<div class="col-md-3 pl-0">\n\t\t\t\t\t\t\t<a class="btn btn-link" (click)="goBack()">Go Back</a>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\t\n\t\t       </div>\n\t\t    </div>\n    \t</app-card>\n    </div>\n</div>',styles:[".resources.table td, .resources.table th{\r\n\twhite-space: initial !important;\r\n\tpadding: 0.5rem 0.5rem;\r\n}"]})],g);let f=class extends g{constructor(t,e,s,r,n,a,o){super(t,e,s,r,n,a,o),this.route=t,this.router=e,this.tokenService=s,this.dataService=r,this.constants=n,this.functions=a,this.toastr=o,this.browseUrl="/resources/archives",this.title="Archives",this.object="Archived Resource"}loadRecords(t,e,s){this.parentID=e,this.moduleCode=t;let r={moduleCode:this.moduleCode,isArchived:"Y"};s&&""!=s.trim()?r={moduleCode:{neq:"kwt"},resourceName:{like:s.trim(),options:"i"},resourceType:"file",isArchived:"Y"}:this.filter.term=null,this.dataService.getAll({limit:100,where:r}).subscribe(t=>{this.rows=t},t=>{this.errorMessage=i.a.handleError(t,l.a.Messages.RECORDS_NOT_FOUND),this.toastr.error(this.errorMessage,l.a.Title.RECORD_OPERATION)});let n=this.constants.moduleCodes[this.moduleCode];this.parents=[{name:n.plural}],this.dataService.getParents(e).subscribe(t=>{for(let e of t)this.parents.push(e)})}deleteRowForever(t){return Object(r.b)(this,void 0,void 0,function*(){let e=yield i.a.alertDelete(l.a.Title.RECORD_OPERATION,l.a.Messages.CONFIRM_DELETE_FOREVER);(null==e?void 0:e.value)&&(Object.assign(t,{isDeleting:!0}),this.dataService.deleteForever(t[this.pk]).subscribe(e=>{Object.assign(t,{isDeleting:!1}),this.rows=this.rows.filter(e=>e[this.pk]!==t[this.pk]),this.toastr.success(l.a.Messages.DELETE_SUCCESS,l.a.Title.RECORD_OPERATION)},e=>{Object.assign(t,{isDeleting:!1}),this.errorMessage=i.a.handleError(e,l.a.Messages.DELETE_FAILURE),this.toastr.error(this.errorMessage,l.a.Title.RECORD_OPERATION)}))})}};f.ctorParameters=()=>[{type:m.a},{type:m.f},{type:c.a},{type:d.a},{type:l.a},{type:i.a},{type:u.b}],f=Object(r.c)([Object(a.Component)({selector:"archives",template:'<div class="row">\n\t<div class="col-sm-12">\n\t    <app-card hidHeader="true" cardClass="table-card" blockClass="p-0">\n\t    \t<div class="row">\n\t    \t\t<div class="col-md-3 col-sm-12">\n\t    \t\t\t<ul class="nav nav-pills mb-3 mt-3 mr-2 ml-2">\n\t\t\t    \t\t<ng-container *ngFor="let m of functions.indexify(this.constants.moduleCodes)\n\t\t\t\t    \t\t\t| KeyFilter:\'isResourcePack\':true">\n\t\t\t\t\t    \t<li class="nav-item"  *ngIf="tokenService.getModules().indexOf(m.name)>-1">\n\t\t\t\t\t    \t\t<a type="button" class="nav-link {{moduleCode==m.name? \'active\' : \'\'}}" \n\t\t\t\t\t    \t\t  routerLink="{{browseUrl}}" [queryParams]="{moduleCode:m.name}">\n\t\t\t\t\t    \t\t\t<i class="fa fa-folder text-warning m-r-10"></i>\n\t\t\t\t\t    \t\t\t{{m?.plural | TitleCase}}\n\t\t\t\t\t    \t\t\t<br/>\n\t\t\t\t\t    \t\t</a>\n\t\t\t\t\t    \t</li>\n\t\t\t\t    \t</ng-container>\n\t\t\t\t  \t</ul>\n\t\t\t\t</div>\t\t  \t\n\t\t\t\t<div class="col-md-9 col-sm-12 pr-5">\n\t\t\t    \t<div class="form-row mt-3 mb-0">\t\t\t  \t\n\t\t\t\t\t\t<div class="form-group col-sm-12">\n\t\t\t\t\t\t\t<input class="form-control" placeholder="Search {{object}} Here.." [(ngModel)]="filter.term"\n\t\t\t\t\t\t\t\t(keyup)="($event.keyCode == 13 ? loadRecords(moduleCode,parentID,filter.term) : null)"/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\t\n\t\t\t\t\t<div class="form-row mt-0 mb-0">\n\t\t\t\t\t\t<div class="form-group col-md-12 form-inline pt-0">\n\t\t\t\t\t\t\t<div *ngFor="let p of parents; let i = index;">\n\t\t\t\t\t\t\t\t<a *ngIf="i==0" title="{{p.name | TitleCase}}" routerLink="{{browseUrl}}" \n\t\t\t\t\t            \t[queryParams]="{moduleCode:moduleCode}">\n\t\t\t\t\t            \t{{p.name | TitleCase}}\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t<a *ngIf="i>0" title="{{p.name | TitleCase}}" routerLink="{{browseUrl}}" \n\t\t\t\t\t            \t[queryParams]="{parentID:p.id,moduleCode:moduleCode}">\n\t\t\t\t\t            \t{{p.name}}\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t<span *ngIf="i<parents.length-1">&nbsp;>>&nbsp;</span>\n\t\t\t\t\t\t\t\t<span *ngIf="i==parents.length-1">&nbsp;>>&nbsp;</span>\n\t\t\t\t\t\t\t</div>\t\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\t\n\t\t\t        <div class="table-responsive">\n\t\t\t          <table class="table table-borderless table-sm resources">\n\t\t\t          \t<thead>\n\t\t\t            <tr>\n\t\t\t              <th width="50">#</th>\n\t\t\t              <th class="cursor">\n\t\t\t\t           \tResource Name\n\t\t\t\t          </th>       \n\t\t\t              <th width="120" class="text-right"><span>Actions</span></th>\n\t\t\t            </tr>\t \n\t\t\t            </thead>                         \t\n\t\t\t\t\t\t<tr *ngIf="!rows || rows.length==0">\n\t\t\t\t\t\t\t<td class="text-center" colspan="100%">\n\t\t\t\t\t\t\t\t{{\n\t\t\t\t\t\t\t\t\terrorMessage? errorMessage :\n\t\t\t\t\t\t\t\t\t(\'Search could not find any \'+ title.toLowerCase() + \' records\')\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t        <tr template #elseBlock *ngFor="let row of rows | RandomSearch:filter.term | \n\t\t\t\t        \tOrderBy:[\'resourceName\'] ; let i=index" \n\t\t\t\t        \t data-type="{{row.resourceType}}" data-id="{{row.resourceID}}"\n\t\t\t\t        \t (drop)="drop($event,row)" (dragover)="allowDrop($event,row)">           \n\t\t\t\t            <td>{{i+1}}.</td>\n\t\t\t\t            <td>\t\t\n\t\t\t\t            \t<p class="cursor" draggable="true" (dragstart)="drag($event,row)">\t\t\t            \t\n\t\t\t\t\t            \t<span class="{{ functions.getResourceIcon(row.mimeType) }} mr-2 ml-2"></span>\n\t\t\t\t\t            \t<a *ngIf="row.resourceType==\'folder\'" routerLink="{{browseUrl}}" \n\t\t\t\t\t            \t\t[queryParams]="{parentID:row[pk],moduleCode:moduleCode}">\n\t\t\t\t\t            \t\t{{row.resourceName}}\n\t\t\t\t\t            \t</a>\n\t\t\t\t\t            \t<a *ngIf="row.resourceType==\'file\'" routerLink="{{ openUrl + row[pk] }}" target="_blank"\n\t\t\t\t\t            \t\t[queryParams]="{parentID:row.parentID, moduleCode:moduleCode, fullScreen:\'Y\'}">\n\t\t\t\t\t            \t\t{{row.resourceName}}\n\t\t\t\t\t            \t</a>\n\t\t\t\t\t            \t<br/>\n\t\t\t\t\t            \t<span class="font-small">\n\t\t\t\t\t\t            \tSize: <b>{{ functions.getResourceSize(row.resourceSize) }}&nbsp;</b> | \n\t\t\t\t\t\t            \t&nbsp; Archived On : {{row?.lastUpdated | date:\'dd-MMM-yyyy hh:mm a\'}}\n\t\t\t\t\t            \t</span>\n\t\t\t\t\t            </p>\n\t\t\t\t            </td>\n\t\t\t\t            <td class="text-right" width="180">\n\t\t\t\t            \t<a title="Open {{object}}" class="text-primary" *ngIf="row.resourceType==\'folder\'" \n\t\t\t\t            \t\trouterLink="{{browseUrl}}" [queryParams]="{parentID:row[pk],moduleCode:moduleCode}">\n\t\t\t\t            \t\t<i class="feather icon-eye"></i> Open\n\t\t\t\t            \t</a>\t\t\t\n\t\t\t\t            \t<a title="Open {{object}}" class="text-primary" *ngIf="row.resourceType==\'file\'" \n\t\t\t\t            \t\trouterLink="{{openUrl + row[pk]}}"  target="_blank"\n\t\t\t\t            \t\t[queryParams]="{parentID:row.parentID, moduleCode:moduleCode, fullScreen:\'Y\'}">\n\t\t\t\t            \t\t<i class="feather icon-eye"></i> Open\n\t\t\t\t            \t</a>\t\t\t\n\t\t\t\t            \t<a *ngIf="tokenService.getUserType()==constants.userTypes.admin.name"\n\t\t\t\t\t\t\t\t\tclass="text-success" [disabled]="row?.isDeleting" type="button" \n\t\t\t\t\t\t\t\t\ttitle="Restore {{object}}" (click)="deleteRow(row)">\n\t\t\t\t\t\t\t\t\t<span *ngIf="row?.isDeleting" class="spinner-border spinner-border-sm"></span>\n\t\t\t\t\t\t\t\t\t<span *ngIf="!row?.isDeleting"><i class="fa fa-undo"></i></span>\n\t\t\t\t\t\t\t\t\tRestore \n\t\t\t\t\t\t\t\t</a>\t\n\t\t\t\t\t\t\t\t<br/>\t\n\t\t\t\t\t\t\t\t<a *ngIf="tokenService.getUserType()==constants.userTypes.admin.name"\n\t\t\t\t\t\t\t\t\tclass="text-danger" [disabled]="row?.isDeleting" type="button" \n\t\t\t\t\t\t\t\t\ttitle="Delete {{object}} Forever" (click)="deleteRowForever(row)">\n\t\t\t\t\t\t\t\t\t<span *ngIf="row?.isDeleting" class="spinner-border spinner-border-sm"></span>\n\t\t\t\t\t\t\t\t\t<span *ngIf="!row?.isDeleting"><i class="fa fa-trash"></i></span>\n\t\t\t\t\t\t\t\t\tDelete Forever\n\t\t\t\t\t\t\t\t</a>\t\t\t\n\t\t\t\t            </td>\n\t\t\t            </tr>\n\t\t\t          </table>\n\t\t\t        </div>\n\t\t\t        <div class="form-group form-inline pl-0">\n\t\t\t\t\t\t<div class="col-md-3 pl-0">\n\t\t\t\t\t\t\t<a class="btn btn-link" (click)="goBack()">Go Back</a>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\t\n\t\t       </div>\n\t\t    </div>\n    \t</app-card>\n    </div>\n</div>',styles:[".resources.table td, .resources.table th{\r\n\twhite-space: initial !important;\r\n\tpadding: 0.5rem 0.5rem;\r\n}"]})],f);let v=class{constructor(t,e,s,r,n,a,o){this.route=t,this.router=e,this.tokenService=s,this.dataService=r,this.constants=n,this.functions=a,this.toastr=o,this.pk="resourceID",this.title="Knowledge Topics",this.object="Knowledge Topics",this.dashboardUrl="/dashboard",this.openUrl="/resources/open/",this.browseUrl="/resources/knowledge-center",this.uploadUrl="/resources/upload",this.createUrl="/resources/create-folder",this.editUrl="/resources/edit-folder/",this.rows=[],this.errorMessage=null,this.filter={term:null},this.moduleCode="kwt",this.parentID=null,this.parents=[],this.loading=!1}ngOnInit(){this.parentID=this.route.snapshot.queryParams.parentID||null,this.route.queryParams.subscribe(t=>{let e=t.parentID||null;this.loadRecords(this.moduleCode,e)}),this.loadRecords(this.moduleCode,this.parentID)}loadRecords(t,e,s){this.parentID=e,this.moduleCode=t;let r={moduleCode:this.moduleCode,parentID:e};s&&""!=s.trim()?r={moduleCode:this.moduleCode,resourceType:"file",resourceName:{like:s.trim(),options:"i"}}:this.filter.term=null,this.dataService.getAll({limit:100,where:r}).subscribe(t=>{this.rows=t},t=>{this.errorMessage=i.a.handleError(t,l.a.Messages.RECORDS_NOT_FOUND),this.toastr.error(this.errorMessage,l.a.Title.RECORD_OPERATION)}),this.parents=[{name:"Knowledge Centre"}],this.dataService.getParents(e).subscribe(t=>{for(let e of t)this.parents.push(e)})}deleteRow(t){return Object(r.b)(this,void 0,void 0,function*(){let e=yield i.a.alertDelete(l.a.Title.RECORD_OPERATION,l.a.Messages.CONFIRM_DELETE);(null==e?void 0:e.value)&&(Object.assign(t,{isDeleting:!0}),this.dataService.delete(t[this.pk]).subscribe(e=>{Object.assign(t,{isDeleting:!1}),this.rows=this.rows.filter(e=>e[this.pk]!==t[this.pk]),this.toastr.success(l.a.Messages.DELETE_SUCCESS,l.a.Title.RECORD_OPERATION)},e=>{Object.assign(t,{isDeleting:!1}),this.errorMessage=i.a.handleError(e,l.a.Messages.DELETE_FAILURE),this.toastr.error(this.errorMessage,l.a.Title.RECORD_OPERATION)}))})}allowDrop(t,e){t.preventDefault()}drag(t,e){t.dataTransfer.setData("resourceID",e.resourceID)}drop(t,e){return Object(r.b)(this,void 0,void 0,function*(){if(t.preventDefault(),"folder"!=e.resourceType)return;let s=t.dataTransfer.getData("resourceID"),r=e.resourceID,n="Do you want to move the selected resource to \n"+e.resourceName+"?",a=yield i.a.alertDelete(l.a.Title.RECORD_OPERATION,n);(null==a?void 0:a.value)&&(this.loading=!0,this.dataService.update(s,{parentID:r}).subscribe(()=>{let t=h.findIndex(this.rows,{resourceID:s});t>=0&&this.rows.splice(t,1),this.toastr.success(l.a.Messages.RESOURCE_MOVE,l.a.Title.RECORD_OPERATION)}).add(()=>{this.loading=!1}))})}goBack(){if(this.parents.length>1){let t={parentID:this.parents[this.parents.length-2].id,moduleCode:this.moduleCode,fullScreen:"N"};this.router.navigate([this.browseUrl],{queryParams:t})}else this.router.navigate([this.dashboardUrl],{queryParams:{fullScreen:"N"}})}};v.ctorParameters=()=>[{type:m.a},{type:m.f},{type:c.a},{type:d.a},{type:l.a},{type:i.a},{type:u.b}],v=Object(r.c)([Object(a.Component)({selector:"knowledge-center",template:'<div class="row">\n\t<div class="col-sm-12">\n\t    <app-card hidHeader="true" cardClass="table-card" blockClass="p-0">\n\t    \t<div class="row">\t  \t\n\t\t\t\t<div class="col-md-12 col-sm-12 pr-5">\n\t\t\t    \t<div class="form-row mt-3 mb-0">\n\t\t\t    \t\t<div class="form-group col-md-3 col-sm-12 pl-4"\n\t\t    \t\t\t\t*ngIf="tokenService.getUserType()==constants.userTypes.admin.name">\n\t\t\t    \t\t\t<a *ngIf="tokenService.getUserType()==constants.userTypes.admin.name"\n\t\t\t\t           \t\ttitle="Upload {{object}}" \n\t\t\t\t           \t\tclass="btn waves-effect waves-light btn-rounded btn-outline-primary" \n\t\t\t\t           \t\trouterLink="{{createUrl}}" \n\t\t\t\t           \t\t[queryParams]="{parentID:parentID, moduleCode:moduleCode}">\n\t\t\t\t\t\t\t\t<i class="fa fa-plus"></i> Create Folder\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</div>\t\t\t  \t\n\t\t\t\t\t\t<div class="form-group {{tokenService.getUserType()==constants.userTypes.admin.name? \'col-md-6\' : \'col-md-12\'}} col-sm-12 pl-3">\n\t\t\t\t\t\t\t<input class="form-control" placeholder="Search {{object}} Here.." [(ngModel)]="filter.term"\n\t\t\t\t\t\t\t\t(keyup)="($event.keyCode == 13 ? loadRecords(moduleCode,parentID,filter.term) : null)"/>\n\t\t\t\t\t\t</div>\t\t\t\t\t\t\n\t\t\t\t\t  \t<div class="form-group col-md-3 col-sm-12 text-right"\n\t\t\t\t\t  \t\t*ngIf="tokenService.getUserType()==constants.userTypes.admin.name">\n\t\t\t\t            <a *ngIf="tokenService.getUserType()==constants.userTypes.admin.name"\n\t\t\t\t           \t\ttitle="Upload File" class="btn waves-effect waves-light btn-rounded btn-outline-primary" \n\t\t\t\t           \t\trouterLink="{{uploadUrl}}" [queryParams]="{parentID:parentID, moduleCode:moduleCode}">\n\t\t\t\t\t\t\t\t<i class="fa fa-upload"></i> Upload File\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\t\t\t\t\t\t\n\t\t\t\t\t<div class="form-row mt-0 mb-0 ml-3">\n\t\t\t\t\t\t<div class="form-group col-md-12 form-inline pt-0">\n\t\t\t\t\t\t\t<div *ngFor="let p of parents; let i = index;">\n\t\t\t\t\t\t\t\t<a *ngIf="i==0" title="{{p.name | TitleCase}}" routerLink="{{browseUrl}}" \n\t\t\t\t\t            \t[queryParams]="{moduleCode:moduleCode}">\n\t\t\t\t\t            \t{{p.name | TitleCase}}\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t<a *ngIf="i>0" title="{{p.name | TitleCase}}" routerLink="{{browseUrl}}" \n\t\t\t\t\t            \t[queryParams]="{parentID:p.id,moduleCode:moduleCode}">\n\t\t\t\t\t            \t{{p.name | TitleCase}}\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t<span *ngIf="i<parents.length-1">&nbsp;>>&nbsp;</span>\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t<span *ngIf="i==parents.length-1">&nbsp;>>&nbsp;</span>\n\t\t\t\t\t\t\t</div>\t\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\t\t\t\n\t\t\t        <div class="table-responsive">\n\t\t\t          <table class="table table-borderless table-sm resources">\n\t\t\t          \t<thead>\n\t\t\t            <tr>\n\t\t\t              <th width="50">#</th>\n\t\t\t              <th>Resource Name</th>\n\t\t\t              <th width="100" class="text-right">Item Size</th>\n\t\t\t              <th width="170">Last Updated On</th>\n\t\t\t              <th class="text-right"><span>Actions</span></th>\n\t\t\t            </tr>\t \n\t\t\t            </thead>                         \t\n\t\t\t\t\t\t<tr *ngIf="!rows || rows.length==0">\n\t\t\t\t\t\t\t<td class="text-center" colspan="100%">\n\t\t\t\t\t\t\t\t{{\n\t\t\t\t\t\t\t\t\terrorMessage? errorMessage :\n\t\t\t\t\t\t\t\t\t(\'Search could not find any \'+ title.toLowerCase() + \' records\')\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t        <tr template #elseBlock *ngFor="let row of rows | RandomSearch:filter.term | \n\t\t\t\t        \tOrderBy:[\'resourceName\'] ; let i=index"\n\t\t\t\t        \tdata-type="{{row.resourceType}}" data-id="{{row.resourceID}}"\n\t\t\t\t        \t(drop)="drop($event,row)" (dragover)="allowDrop($event,row)">           \n\t\t\t\t            <td>{{i+1}}.</td>\n\t\t\t\t            <td>\n\t\t\t\t            \t<p class="cursor" draggable="true" (dragstart)="drag($event,row)">\n\t\t\t\t\t            \t<span class="{{ functions.getResourceIcon(row.mimeType) }} mr-2 ml-2"></span>\n\t\t\t\t\t            \t<a *ngIf="row.resourceType==\'folder\'" routerLink="{{browseUrl}}" \n\t\t\t\t\t            \t\t[queryParams]="{parentID:row[pk],moduleCode:moduleCode}">\n\t\t\t\t\t            \t\t{{row.resourceName | TitleCase}}\n\t\t\t\t\t            \t</a>\n\t\t\t\t\t            \t<a *ngIf="row.resourceType==\'file\'" routerLink="{{ openUrl + row[pk] }}"\n\t\t\t\t\t            \t\t[queryParams]="{parentID:row.parentID,moduleCode:moduleCode, fullScreen:\'Y\'}"  target="_blank">\n\t\t\t\t\t            \t\t{{row.resourceName | TitleCase}}\n\t\t\t\t\t            \t</a>\n\t\t\t\t\t            </p>\n\t\t\t\t            </td>\n\t\t\t\t            <td class="text-right">{{ functions.getResourceSize(row.resourceSize) }}</td>\n\t\t\t\t            <td>{{row?.lastUpdated | date:\'dd-MMM-yyyy hh:mm a\'}}</td>\n\t\t\t\t            <td class="text-right" width="180">\n\t\t\t\t            \t<a title="Open {{object}}" class="text-primary" \n\t\t\t\t            \t\trouterLink="{{browseUrl}}" *ngIf="row.resourceType==\'folder\'"\n\t\t\t\t            \t\t[queryParams]="{parentID:row[pk],moduleCode:moduleCode}">\n\t\t\t\t            \t\t<i class="feather icon-eye"></i> Open\n\t\t\t\t            \t</a>\t\t\t\n\t\t\t\t            \t<a title="Open {{object}}" class="text-primary" target="_blank"\n\t\t\t\t            \t\trouterLink="{{openUrl + row[pk]}}" *ngIf="row.resourceType==\'file\'"\n\t\t\t\t            \t\t[queryParams]="{parentID:row.parentID,moduleCode:moduleCode,fullScreen:\'Y\'}">\n\t\t\t\t            \t\t<i class="feather icon-eye"></i> Open\n\t\t\t\t            \t</a>\t\n\t\t\t\t            \t<a title="Edit {{object}}" class="text-success"\n\t\t\t\t\t\t\t\t\t*ngIf="tokenService.getUserType()==constants.userTypes.admin.name\n\t\t\t\t\t\t\t\t\t&& row.resourceType==\'folder\'" routerLink="{{editUrl + row[pk]}}"\n\t\t\t\t\t\t\t\t\t[queryParams]="{parentID:row.parentID, moduleCode:moduleCode}">\n\t\t\t\t\t\t\t\t\t&nbsp;|&nbsp;&nbsp;<i class="feather icon-edit"></i> Edit\n\t\t\t\t\t\t\t\t</a>\t\n\t\t\t\t\t\t\t\t<br/>\t\t\t\t\n\t\t\t\t\t\t\t\t<a *ngIf="tokenService.getUserType()==constants.userTypes.admin.name"\n\t\t\t\t\t\t\t\t\tclass="text-danger" [disabled]="row?.isDeleting" type="button" \n\t\t\t\t\t\t\t\t\ttitle="Archive {{object}}" (click)="deleteRow(row)">\n\t\t\t\t\t\t\t\t\t<span *ngIf="row?.isDeleting" class="spinner-border spinner-border-sm"></span>\n\t\t\t\t\t\t\t\t\t<span *ngIf="!row?.isDeleting"><i class="feather icon-trash"></i></span>\n\t\t\t\t\t\t\t\t\tArchive\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t            </td>\t\t\t\t            \t\t\t\n\t\t\t            </tr>\n\t\t\t          </table>\n\t\t\t        </div>\n\t\t\t        <div class="form-group form-inline pl-0">\n\t\t\t\t\t\t<div class="col-md-3 pl-0">\n\t\t\t\t\t\t\t<a class="btn btn-link" (click)="goBack()">Go Back</a>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\t\n\t\t       </div>\n\t\t    </div>\n    \t</app-card>\n    </div>\n</div>',styles:[".resources.table td, .resources.table th{\r\n\twhite-space: initial !important;\r\n\tpadding: 0.5rem 0.5rem;\r\n}"]})],v);var b=s("VITL"),y=s("feko"),w=s("3Pt+"),C=s("SxV6");let I=class{constructor(t,e,s,r,n,a,o,i,l,d){this.formBuilder=t,this.route=e,this.router=s,this.dataService=r,this.toastr=n,this.constants=a,this.functions=o,this.companyService=i,this.tokenService=l,this.userService=d,this.pk="resourceID",this.objects="Folders",this.object="Folder",this.parentUrl="/resources/folders",this.knowlegeUrl="/resources/knowledge-center",this.browseUrl="/resources/folders",this.loading=!1,this.errorMessage="",this.submitted=!1,this.moduleCode="",this.parentID=null,this.companies=[],this.parents=[],this.actors={rows:[],selected:[]},this.autocompleteArray=[],this.autocompleteField="name",this.autocompleteModel=null}ngOnInit(){this.id=this.route.snapshot.params.id,this.parentID=this.route.snapshot.queryParams.parentID||null,this.moduleCode=(this.route.snapshot.queryParams.moduleCode||"").trim().toLowerCase(),this.isAddMode=!this.id,this.title=(this.isAddMode?"Add":"Edit")+" "+this.object,this.parentUrl="kwt"==this.moduleCode?this.knowlegeUrl:this.parentUrl,this.objects="kwt"==this.moduleCode?"Knowledge Center":this.objects,this.form=this.formBuilder.group({parentID:[this.parentID],companyID:[this.tokenService.getSelectedCompany().companyID||""],moduleCode:[{value:this.moduleCode,disabled:"kwt"==this.moduleCode},w.j.required],resourceName:["",w.j.required],resourceSize:[0],resourceType:["folder"],mimeType:["Folder"],lastUpdated:[new Date],dateCreated:[new Date],isPublic:["N"]}),this.isAddMode?this.dataService.get(this.parentID).pipe(Object(C.a)()).subscribe(t=>{this.actors.rows=t.actors?t.actors:[],this.actors.selected=t.actors?h.map(t.actors,"id"):[]}):this.dataService.get(this.id).pipe(Object(C.a)()).subscribe(t=>{this.actors.rows=t.actors?t.actors:[],this.actors.selected=t.actors?h.map(t.actors,"id"):[],this.form.patchValue(t),this.toastr.success(l.a.Messages.RECORD_LOADED,l.a.Title.RECORD_OPERATION)},t=>{this.errorMessage=t.message?t.message:l.a.Messages.RECORDS_NOT_FOUND,this.toastr.error(this.errorMessage,l.a.Title.RECORD_OPERATION),this.router.navigate([this.parentUrl],{relativeTo:this.route})}),this.companyService.getUserCompanies().subscribe(t=>{this.companies=t});let t=this.constants.moduleCodes[this.moduleCode];this.parents=[{name:t.plural}],this.dataService.getParents(this.parentID).subscribe(t=>{for(let e of t)this.parents.push(e)}),this.userService.getAll({where:{userType:{neq:"admin"}}}).subscribe(t=>{for(let e of t){let t=e.fullName+" - "+e.phoneNo;this.autocompleteArray.push(Object.assign(e,{id:e.id,name:t}))}})}onActorRemoved(t,e){if(!e.target.checked){let e=this.actors.selected.indexOf(t.id);this.actors.selected.splice(e,1),this.actors.rows.splice(e,1)}}onActorAdded(t){let e={teamID:t.teamID,id:t.id,fullName:t.fullName,phoneNo:t.phoneNo,email:t.email};0==this.actors.rows.filter(t=>t.id===e.id).length&&(this.actors.rows.push(e),this.actors.selected.push(e.id)),this.autocomplete.clear(),this.autocomplete.focus()}onSubmit(){if(this.submitted=!0,this.form.invalid)return void this.toastr.error(l.a.Messages.FORM_ERROR_FOUND,l.a.Title.FORM_VALIDATION);let t=this.form.value;t.actors=this.actors.rows.length>0?this.actors.rows:null,t.moduleCode=t.moduleCode||this.moduleCode,this.loading=!0,this.isAddMode?this.createRecord(t):this.updateRecord(t)}createRecord(t){this.dataService.create(t).pipe(Object(C.a)()).subscribe(()=>{this.toastr.success(l.a.Messages.SAVE_SUCCESS,l.a.Title.RECORD_OPERATION),this.router.navigate([this.parentUrl],{queryParams:{parentID:this.parentID,moduleCode:this.moduleCode}})},t=>{this.errorMessage=i.a.handleError(t,l.a.Messages.SAVE_FAILURE),this.toastr.error(this.errorMessage,l.a.Title.RECORD_OPERATION)}).add(()=>{this.loading=!1})}updateRecord(t){this.dataService.update(this.id,t).pipe(Object(C.a)()).subscribe(()=>{this.toastr.success(l.a.Messages.UPDATE_SUCCESS,l.a.Title.RECORD_OPERATION),this.router.navigate([this.parentUrl],{queryParams:{parentID:this.parentID,moduleCode:this.moduleCode}})},t=>{this.errorMessage=t.message?t.message:l.a.Messages.UPDATE_FAILURE,this.toastr.error(this.errorMessage,l.a.Title.RECORD_OPERATION)}).add(()=>{this.loading=!1})}get f(){return this.form.controls}};I.ctorParameters=()=>[{type:w.b},{type:m.a},{type:m.f},{type:d.a},{type:u.b},{type:l.a},{type:i.a},{type:y.a},{type:c.a},{type:b.a}],I.propDecorators={autocomplete:[{type:a.ViewChild,args:["autocomplete"]}]},I=Object(r.c)([Object(a.Component)({selector:"create-folder",template:'<app-basic-crumb [title]="title" [objects]="objects" [url]="parentUrl"\n\t[params]="{parentID:parentID, moduleCode: form.get(\'moduleCode\').value}">\n</app-basic-crumb>\n<div class="row">\n\t<div class="col-sm-12">\n\t    <app-card cardTitle="{{\'Create Folder\' | uppercase}}" blockClass="table-border-style">\n\t\t\t<form [formGroup]="form" (ngSubmit)="onSubmit()">\n\t\t\t    <div class="form-row">\n\t\t\t    \t<div class="form-row mt-0 mb-0 pl-1">\n\t\t\t\t\t\t<div class="form-group col-md-12 form-inline pt-0">\n\t\t\t\t\t\t\t<div *ngFor="let p of parents; let i = index;">\n\t\t\t\t\t\t\t\t<a *ngIf="i==0" title="{{p.name | TitleCase}}" routerLink="{{browseUrl}}" \n\t\t\t\t\t            \t[queryParams]="{moduleCode:moduleCode}">\n\t\t\t\t\t            \t{{p.name | TitleCase}}\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t<a *ngIf="i>0" title="{{p.name | TitleCase}}" routerLink="{{browseUrl}}" \n\t\t\t\t\t            \t[queryParams]="{parentID:p.id,moduleCode:moduleCode}">\n\t\t\t\t\t            \t{{p.name | TitleCase}}\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t<span *ngIf="i<parents.length-1">&nbsp;>>&nbsp;</span>\n\t\t\t\t\t\t\t\t<span *ngIf="i==parents.length-1">&nbsp;>>&nbsp;</span>\n\t\t\t\t\t\t\t</div>\t\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\t\n\t\t\t    \t<div class="form-group col-sm-12">\n\t\t\t            <label>Owner Company*</label>\n\t\t\t            <select class="form-control" formControlName="companyID" \n\t\t\t            \t[ngClass]="{ \'is-invalid\': submitted && f.companyID.errors }">\n\t\t\t\t\t  \t\t<option value="">No Company Selected</option>\n\t\t\t\t\t        <option *ngFor="let c of companies | OrderBy:\'fullName\'" value="{{c.companyID}}">\n\t\t\t\t\t        \t{{c.fullName}}\n\t\t\t\t\t        </option>\n\t\t\t\t\t    </select>\n\t\t\t            <div *ngIf="submitted && f.companyID.errors" class="invalid-feedback">\n\t\t\t                <div *ngIf="f.companyID.errors.required">Owner company is required</div>\n\t\t\t            </div>\n\t\t\t        </div>\t\t\t        \n\t\t\t        <div class="form-group col-sm-12">\n\t\t\t            <label>Module Name*</label>\n\t\t\t            <select formControlName="moduleCode" class="form-control">\n\t\t\t\t\t\t    <option *ngFor="let m of functions.indexify(constants.moduleCodes)\n\t\t\t\t    \t\t\t| KeyFilter:\'isResourcePack\':true" value="{{m.name}}">\n\t\t\t\t\t\t    \t{{m?.plural}}\n\t\t\t\t\t\t    </option>\n\t\t\t\t\t\t    <option value="kwt" *ngIf="moduleCode==\'kwt\'">KNOWLEDGE CENTER</option>\n\t\t\t\t\t\t</select>\n\t\t\t            <div *ngIf="submitted && f.moduleCode.errors" class="invalid-feedback">\n\t\t\t                <div *ngIf="f.moduleCode.errors.required">Module name is required</div>\n\t\t\t            </div>\n\t\t\t        </div>\n\t\t\t        <div class="form-group col-sm-12">\n\t\t\t            <label>Resource Name*</label>\n\t\t\t            <input type="text" formControlName="resourceName"  placeholder="Enter folder name"\n\t\t\t            \tclass="form-control" [ngClass]="{ \'is-invalid\': submitted && f.resourceName.errors }"/>\n\t\t\t            <div *ngIf="submitted && f.resourceName.errors" class="invalid-feedback">\n\t\t\t                <div *ngIf="f.resourceName.errors.required">Folder Name is required</div>\n\t\t\t            </div>\n\t\t\t        </div>\t\n\t\t\t        <div class="form-group col-sm-12">\n\t\t\t        \t<div class="checkbox checkbox-primary d-inline">\n\t\t\t              <input type="checkbox" name="isPublic" id="isPublic" \n\t\t\t\t            trueFalseValue trueValue="Y" falseValue="N" formControlName="isPublic">\n\t\t\t              <label for="isPublic" class="cr font-weight-bold">Is This a Public Folder?</label>\n\t\t\t          \t</div>\t\t\t            \n\t\t\t        </div>\t\n\t\t\t        <div class="form-group col-sm-12">\n\t\t\t            <label>Permissions*</label>\n\t\t\t            <div class="form-group">\n\t\t\t\t            <ng-autocomplete \n\t\t\t\t\t\t\t  #autocomplete\n\t\t\t\t\t\t\t  [data]="autocompleteArray"\n\t\t\t\t\t\t\t  placeholder="Search users to add to give permissions"\n\t\t\t\t\t\t\t  [searchKeyword]="autocompleteField"\n\t\t\t\t\t\t\t  (selected)=\'onActorAdded($event)\'\n\t\t\t\t\t\t\t  [ngModel] = \'autocompleteModel\'\n\t\t\t\t\t\t\t  [ngModelOptions]=\'{standalone: true}\'\n\t\t\t\t\t\t\t  [itemTemplate]="itemTemplate"\n\t\t\t\t\t\t\t  [notFoundTemplate]="notFoundTemplate">                                 \n\t\t\t\t\t\t\t</ng-autocomplete>\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t<ng-template #itemTemplate let-item>\n\t\t\t\t\t\t\t\t<a [innerHTML]="item.name"></a>\n\t\t\t\t\t\t\t</ng-template>\t\t\t\t\t\t\n\t\t\t\t\t\t\t<ng-template #notFoundTemplate let-notFound>\n\t\t\t\t\t\t\t\t<div [innerHTML]="notFound"></div>\n\t\t\t\t\t\t\t</ng-template>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="form-group mt-2" *ngIf="actors.rows">\n\t\t\t\t\t       \t<div *ngFor="let row of actors.rows | OrderBy:\'fullName\';">\n\t\t\t\t\t       \t  \t<div class="col-md-12 col-sm-12 col-xs-12">\n\t\t\t\t\t\t          <div class="checkbox checkbox-primary d-inline">\n\t\t\t\t\t\t              <input type="checkbox" name="{{row.fullName}}" id="{{row.id}}" \n\t\t\t\t\t\t              \t(change)="onActorRemoved(row,$event)" [checked]="actors.selected.indexOf(row.id)>-1">\n\t\t\t\t\t\t              <label for="{{row.id}}" class="cr">{{row.fullName}}</label>\n\t\t\t\t\t\t          </div>\n\t\t\t\t\t\t        </div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t        </div>\t\t\t        \n\t\t\t\t</div>\t\t\t\t\n\t\t\t    <div class="form-group">\n\t\t\t        <button [disabled]="loading" class="btn btn-primary">\n\t\t\t            <span *ngIf="loading" class="spinner-border spinner-border-sm mr-1"></span>\n\t\t\t            Save\n\t\t\t        </button>\n\t\t\t        <a class="btn btn-link" routerLink="{{parentUrl}}"\n\t\t\t          [queryParams]="{parentID:parentID, moduleCode:form.get(\'moduleCode\').value}">\n\t\t\t          Cancel\n\t\t\t        </a>\n\t\t\t    </div>\n\t\t\t</form>\n\t\t</app-card>\n\t</div>\n</div>',styles:[""]})],I);const D=s("AytR").a.pdfApiKey;let O=class{constructor(t){this.tokenStorage=t,this.readyPromise=new Promise(t=>{window.AdobeDC?t(null):document.addEventListener("adobe_dc_view_sdk.ready",()=>{t(null)})})}ready(){return this.readyPromise}previewFile(t,e,s){e=e||{},Object.assign(e,{enableAnnotationAPIs:!0,includePDFAnnotations:!0});const r={clientId:D};t&&(r.divId=t),this.adobeDCView=new window.AdobeDC.View(r);this.pdfRef=this.adobeDCView.previewFile({content:{location:{url:s}},metaData:{fileName:"board.pdf",id:"board"}},e);const n=this.tokenStorage.getUser(),a=n.fullName.split(" ").filter(String),o={userProfile:{name:n.fullName,firstName:a[0],lastName:a.length>1?a[1]:a[0],email:n.email}};this.adobeDCView.registerCallback(window.AdobeDC.View.Enum.CallbackType.GET_USER_PROFILE_API,function(){return new Promise((t,e)=>{t({code:window.AdobeDC.View.Enum.ApiResponseCode.SUCCESS,data:o})})},{})}};O.ctorParameters=()=>[{type:c.a}],O=Object(r.c)([Object(a.Injectable)({providedIn:"root"})],O);var k=s("jhN1");let T=class{constructor(t,e,s,r,n,a,o,i,l){this.route=t,this.resourceService=e,this.constants=s,this.functions=r,this.tokenStorage=n,this.toastr=a,this.sanitizer=o,this.viewSDKClient=i,this.titleService=l,this.parentUrl="/resources/folders",this.knowlegeUrl="/resources/knowledge-center",this.moduleCode="",this.parentID=null,this.title="PDF Editor",this.annotations="Y"}ngOnInit(){this.id=this.route.snapshot.params.id,this.moduleCode=(this.route.snapshot.queryParams.moduleCode||"").trim().toLowerCase(),this.parentID=this.route.snapshot.queryParams.parentID||null,this.parentUrl="kwt"==this.moduleCode?this.knowlegeUrl:this.parentUrl,this.documentURL=this.resourceService.downloadUrl+this.id+"?"+this.tokenStorage.getClientCodeQuery(),this.sanitizedURL=this.sanitizer.bypassSecurityTrustResourceUrl(this.documentURL),this.resourceService.get(this.id).subscribe(t=>{this.titleService.setTitle(t.resourceName)})}ngAfterContentInit(){this.renderPDf()}renderPDf(){if("N"==this.annotations){const t=document.querySelector("#pdf-div");t&&(t.style.display="none")}else this.viewSDKClient.ready().then(()=>{document.querySelector("#pdf-div").style.display="N"==this.annotations?"none":"block";let t={showAnnotationTools:!0,enableFormFilling:!0,showDownloadPDF:"admin"==this.tokenStorage.getUserType(),showPrintPDF:"admin"==this.tokenStorage.getUserType()};this.viewSDKClient.previewFile("pdf-div",t,this.documentURL)})}};T.ctorParameters=()=>[{type:m.a},{type:d.a},{type:l.a},{type:i.a},{type:c.a},{type:u.b},{type:k.DomSanitizer},{type:O},{type:k.Title}],T=Object(r.c)([Object(a.Component)({selector:"open",template:'<div class="row">\n\t<div class="col-sm-12">\t \n\t\t<div id=\'pdf-div\' style="display:none" class=\'pdf-view\'></div>\n\t\t<iframe *ngIf="annotations==\'N\' && sanitizedURL" class="pdf-view" [src]="sanitizedURL"></iframe>\n\t\t<div class="form-group form-inline">\n\t\t\t<div class="col-md-3">\n\t\t\t\t<a routerLink="{{parentUrl}}" class="btn btn-link"\n\t\t\t\t\t[queryParams]="{parentID:parentID, moduleCode:moduleCode, fullScreen:\'N\'}">Go Back</a>\n\t\t\t</div>\t\n\t\t\t<div class="col-md-9 text-right" *ngIf="false">\n\t\t\t\t<div class="checkbox checkbox-primary pt-2 text-right">\n\t\t              <input type="checkbox" name="annotations" id="annotations" \n\t\t                trueFalseValue trueValue="Y" falseValue="N" [(ngModel)]="annotations"\n\t\t                (change)="annotations==\'Y\'? renderPDf() : renderPDf()">\n\t\t              <label for="annotations" class="cr">\n\t\t              \t\tOpen PDF Annotation Features\n\t\t              \t\t<span class="feather icon-comment"></span>\n\t\t              </label>\n\t\t        </div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>',styles:[".pdf-view {\r\n    margin: auto;\r\n    margin-top: 0px;\r\n    height: calc(100vh - 50px);\r\n    width: 100%;\r\n    border: 1px solid #dadada;\r\n    overflow: hidden;\r\n}"]})],T);var S=s("XhZV"),R=s("gG2O");const P=[{path:"",redirectTo:"folders",pathMatch:"full"},{path:"folders",component:g,canActivate:[R.a]},{path:"knowledge-center",component:v,canActivate:[R.a]},{path:"archives",component:f,canActivate:[R.a]},{path:"upload",component:S.a,canActivate:[R.a],data:{roles:["admin"]}},{path:"open/:id",component:T,canActivate:[R.a]},{path:"create-folder",component:I,canActivate:[R.a],data:{roles:["admin"]}},{path:"edit-folder/:id",component:I,canActivate:[R.a],data:{roles:["admin"]}}];let E=class{};E=Object(r.c)([Object(a.NgModule)({imports:[m.g.forChild(P)],exports:[m.g]})],E);var U=s("1kSV");let M=class{};M=Object(r.c)([Object(a.NgModule)({declarations:[g,S.a,T,I,v,f],imports:[o.CommonModule,E,n.a,U.g,U.h,U.b]})],M)},VITL:function(t,e,s){"use strict";s.d(e,"a",function(){return l});var r=s("mrSG"),n=s("tk/3"),a=s("fXoL");const o=s("AytR").a.apiUrl+"users",i={headers:new n.f({"Content-Type":"application/json"})};let l=class{constructor(t){this.http=t}getAll(t){return t=t||{},this.http.get(o+"?filter="+JSON.stringify(t),i)}getAllByUserID(t,e){let s={where:{id:{inq:t=Array.isArray(t)?t:[t]}}};return e&&Object.assign(s.where,{companyID:e}),this.http.get(o+"?filter="+JSON.stringify(s),i)}getAllByType(t,e){let s={where:{userType:t}};return e&&Object.assign(s.where,{companyID:e}),this.http.get(o+"?filter="+JSON.stringify(s),i)}get(t){return this.http.get(`${o}/${t}`)}create(t){return this.http.post(o,t,i)}update(t,e){return this.http.patch(`${o}/${t}`,e,i)}delete(t){return this.http.delete(`${o}/${t}`,i)}deleteAll(){return this.http.delete(o,i)}deleteForever(t){return this.http.delete(`${o}/forever/${t}`,i)}deleteAllForever(){return this.http.delete("API_BASE/forever",i)}findByName(t){return this.http.get(`${o}?FullName=${t}`,i)}};l.ctorParameters=()=>[{type:n.b}],l=Object(r.c)([Object(a.Injectable)({providedIn:"root"})],l)},XhZV:function(t,e,s){"use strict";s.d(e,"a",function(){return m});var r=s("mrSG"),n=s("FQmJ"),a=s("feko"),o=s("d+0u"),i=s("/Uzn"),l=s("9+1D"),d=s("fXoL"),c=s("tk/3"),p=s("5eHb"),u=s("tyNb");let m=class{constructor(t,e,s,r,n,a,o){this.route=t,this.uploadService=e,this.companyService=s,this.tokenService=r,this.constants=n,this.functions=a,this.toastr=o,this.moduleCode="",this.parentUrl="/resources/folders",this.knowlegeUrl="/resources/knowledge-center",this.browseUrl="/resources/folders",this.parentID=null,this.objects="Resources",this.title="Upload Resource",this.errorMessage="",this.companies=[],this.companyID="",this.parents=[],this.documents=[],this.uploadService.selectedFiles}ngOnInit(){this.moduleCode=(this.route.snapshot.queryParams.moduleCode||"").trim().toLowerCase(),this.parentID=this.route.snapshot.queryParams.parentID||null,this.parentUrl="kwt"==this.moduleCode?this.knowlegeUrl:this.parentUrl,this.objects="kwt"==this.moduleCode?"Knowledge Center":this.objects,this.uploadService.selectedFiles=[],this.companyID=this.tokenService.getSelectedCompany().companyID||"",this.companyService.getUserCompanies().subscribe(t=>{this.companies=t});let t=this.constants.moduleCodes[this.moduleCode];this.parents=[{name:t.plural}],this.uploadService.getParents(this.parentID).subscribe(t=>{for(let e of t)this.parents.push(e)})}addMetaInfo(t){Object.assign(t,{value:0,error:!1,message:null,data:{moduleCode:this.moduleCode,parentID:this.parentID,resourceName:t.name,resourceSize:t.size,resourceType:"file",mimeType:t.type}})}selectFiles(t){for(let e of t.target.files)this.addMetaInfo(e),this.uploadService.selectedFiles.push(e)}removeFiles(t){t?this.uploadService.selectedFiles.splice(t,1):this.uploadService.selectedFiles=[]}uploadFiles(t,e,s,r){e=e||this.moduleCode,s=s||this.parentID,t=t||this.companyID,r=r||{},this.uploadService.progress.all=0,this.uploadService.progress.completed=0,this.uploadService.progress.failed=0;for(let n=0;n<this.uploadService.selectedFiles.length;n++){let a=this.uploadService.selectedFiles[n],o=a.data&&a.data.extraData?a.data.extraData:{};this.addMetaInfo(a),Object.assign(a.data,{moduleCode:e,parentID:s,companyID:t,extraData:Object.assign(o,r)}),this.upload(n,a)}}upload(t,e){this.uploadService.upload(e).subscribe(e=>{e.type===c.e.UploadProgress?this.uploadService.selectedFiles[t].value=Math.round(100*e.loaded/e.total):c.i,this.uploadService.selectedFiles[t].message="upload success",this.uploadService.progress.all++,this.uploadService.progress.completed++},e=>{this.uploadService.selectedFiles[t].error=!0,this.uploadService.selectedFiles[t].message="upload failure",this.uploadService.selectedFiles[t].value=0,this.uploadService.progress.all++,this.uploadService.progress.failed++})}deleteResource(t){return Object(r.b)(this,void 0,void 0,function*(){let e=yield i.a.alertDelete(o.a.Title.RECORD_OPERATION,o.a.Messages.CONFIRM_DELETE);(null==e?void 0:e.value)&&(Object.assign(t,{isDeleting:!0}),this.uploadService.delete(t.resourceID).subscribe(e=>{Object.assign(t,{isDeleting:!1}),this.documents=this.documents.filter(e=>e.resourceID!==t.resourceID),this.toastr.success(o.a.Messages.DELETE_SUCCESS,o.a.Title.RECORD_OPERATION)},e=>{Object.assign(t,{isDeleting:!1}),this.errorMessage=i.a.handleError(e,o.a.Messages.DELETE_FAILURE),this.toastr.error(this.errorMessage,o.a.Title.RECORD_OPERATION)}))})}};m.ctorParameters=()=>[{type:u.a},{type:l.a},{type:a.a},{type:n.a},{type:o.a},{type:i.a},{type:p.b}],m=Object(r.c)([Object(d.Component)({selector:"upload",template:'<app-basic-crumb [title]="title" [objects]="objects" [url]="parentUrl"\n\t[params]="{parentID:parentID, moduleCode:moduleCode}">\n</app-basic-crumb>\n<div class="row">\n\t<div class="col-sm-12">\t    \n\t    <app-card cardTitle="{{\'File Uploader\' | uppercase}}" \n\t    \tcardClass="table-card" blockClass="pl-3 pr-3 pb-0 pt-0 mb-0">\n\t    \t<div class="form-row mt-0 mb-0 pl-3">\n\t\t\t\t<div class="form-group col-md-12 form-inline pt-0">\n\t\t\t\t\t<div *ngFor="let p of parents; let i = index;">\n\t\t\t\t\t\t<a *ngIf="i==0" title="{{p.name | TitleCase}}" routerLink="{{browseUrl}}" \n\t\t\t            \t[queryParams]="{moduleCode:moduleCode}">\n\t\t\t            \t{{p.name | TitleCase}}\n\t\t\t\t\t\t</a>\n\t\t\t\t\t\t<a *ngIf="i>0" title="{{p.name | TitleCase}}" routerLink="{{browseUrl}}" \n\t\t\t            \t[queryParams]="{parentID:p.id,moduleCode:moduleCode}">\n\t\t\t            \t{{p.name | TitleCase}}\n\t\t\t\t\t\t</a>\n\t\t\t\t\t\t<span *ngIf="i<parents.length-1">&nbsp;>>&nbsp;</span>\n\t\t\t\t\t\t<span *ngIf="i==parents.length-1">&nbsp;>>&nbsp;</span>\n\t\t\t\t\t</div>\t\n\t\t\t\t</div>\n\t\t\t</div>\t\n\t    \t<div class="form-group col-sm-12">\n\t            <label>Owner Company*</label>\n\t            <select class="form-control" [(ngModel)]="companyID">\n\t\t\t  \t\t<option value="">No Company Selected</option>\n\t\t\t        <option *ngFor="let c of companies | OrderBy:\'fullName\'" value="{{c.companyID}}">\n\t\t\t        \t{{c.fullName}}\n\t\t\t        </option>\n\t\t\t    </select>\n\t        </div>\t\t\n\t    \t<div class="form-group col-sm-12">\n\t    \t\t<label>Select Module To Upload To</label>\n\t\t\t\t<select [(ngModel)]="moduleCode" class="form-control" [disabled]="moduleCode==\'kwt\'">\n\t\t\t\t    <option *ngFor="let m of functions.indexify(constants.moduleCodes)\n\t\t    \t\t\t| KeyFilter:\'isResourcePack\':true" value="{{m.name}}">\n\t\t\t\t    \t{{m?.plural}}\n\t\t\t\t    </option>\n\t\t\t\t    <option value="kwt" *ngIf="moduleCode==\'kwt\'">KNOWLEDGE CENTER</option>\n\t\t\t\t</select>\n\t\t\t</div>\n\t    \t\n\t    \t<div class="form-group col-sm-12" *ngIf="uploadService.selectedFiles.length==0">\n\t\t\t\t<div class="text-left text-danger" colspan="100%">\n\t\t\t\t\tNo files added to the queue! Click add button below.\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t \n\t\t\t<div class="form-group col-sm-12" template #elseBlock>\n\t\t\t\t<div *ngFor="let f of uploadService.selectedFiles; let i = index;" class="mb-2">\n\t\t\t\t  <span>\n\t\t\t\t  \t<span class="{{ functions.getResourceIcon(f.data.mimeType) }} mr-2 ml-2"></span>\n\t\t\t\t  \t{{ f.data.resourceName }}\n\t\t\t\t  </span>\n\t\t\t\t  <span> &nbsp; | &nbsp; {{ functions.getResourceSize(f.data.resourceSize) }}</span>\n\t\t\t\t  &nbsp;\n\t\t\t\t  <a type="button" (click)="removeFiles(i)">\n\t\t\t\t  \t<span class="fa fa-times text-danger cursor"></span>\n\t\t\t\t  </a>\n\t\t\t\t  <span class="{{f.error? \'text-danger\' : \'text-success\'}}" *ngIf="f.message">\n\t\t\t\t  \t&nbsp; | &nbsp; {{f.message}}\n\t\t\t\t  </span>\n\t\t\t\t  <div class="progress">\n\t\t\t\t    <div class="progress-bar progress-bar-info progress-bar-striped"\n\t\t\t\t      role="progressbar" *ngIf="!(f.value==100)"\n\t\t\t\t      attr.aria-valuenow="{{ f.value }}"\n\t\t\t\t      aria-valuemin="0"\n\t\t\t\t      aria-valuemax="100"\n\t\t\t\t      [ngStyle]="{ width: f.value + \'%\' }">\n\t\t\t\t      {{ f.value }}%\n\t\t\t\t    </div>\n\t\t\t\t  </div>\t\t\t  \n\t\t\t\t</div>\t\n\t\t\t</div>\n\t\t\t\n\t\t\t<div class="form-group">\n\t\t\t\t<a class="btn btn-link" routerLink="{{parentUrl}}"\n\t\t\t\t\t[queryParams]="{parentID:parentID, moduleCode:moduleCode}">Go Back</a>\t\t\n\t\t\t\t<button type="button" class="btn btn-primary" (click)="fileInput.click()">\n\t\t\t\t\t<i class="fa fa-plus"></i> \n\t\t\t\t\tAdd Files\n\t\t\t\t</button>\n\t\t\t\t<input type="file" multiple="true" (change)="selectFiles($event)" \n\t\t\t\t  \tstyle="display: none" #fileInput/>\n\t\t\t\t&nbsp;\n\t\t\t\t<button class="btn btn-primary" *ngIf="uploadService.selectedFiles.length>0" (click)="uploadFiles()">\n\t\t\t\t\t<i class="fa fa-upload"></i>\n\t\t\t\t  \tUpload All\n\t\t\t\t</button>\t\n\t\t\t\t&nbsp;\t\t\n\t\t\t\t<button class="btn btn-danger" *ngIf="uploadService.selectedFiles.length>0" (click)="removeFiles()">\n\t\t\t\t\t<i class="fa fa-upload"></i>\n\t\t\t\t  \tRemove All\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</app-card>\n\t</div>\n</div>',styles:[""]})],m)}}]);